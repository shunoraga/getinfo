<!DOCTYPE html>
<html>
<head>
    <title>Meu Site Hello World</title>
    <script src="//wurfl.io/wurfl.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-database.js";

        // Configuração do Firebase
        const firebaseConfig = {
            // Suas configurações do Firebase
        };

        // Inicializando o Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Função para enviar dados para o Realtime Database
        function sendDataToRealtimeDatabase(data) {
            const dbRef = ref(database, 'visitors');
            push(dbRef, data, function(error) {
                if (error) {
                    console.error("Dados não foram salvos.", error);
                } else {
                    console.log("Dados salvos com sucesso.");
                }
            });
        }

        // Funções de Geolocalização
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                console.log("Geolocalização não é suportada por este navegador.");
            }
        }

        function showPosition(position) {
            var locationData = {
                latitude: position.coords.latitude,
                longitude: position.coords.longitude
            };
            sendDataToRealtimeDatabase(locationData);
        }

        function showError(error) {
            // Tratamento de erros de geolocalização
        }

        // Chamada da API VisitorAPI
        var VisitorAPI = function(t, e, a) {
            // Implementação da API VisitorAPI
        };

        // Chamada da API e envio dos dados para o Firebase
        VisitorAPI(
            "p53oy0LRsYVI5KEmIDJw",
            function(data) { 
                // Coletando dados do WURFL.js
                var deviceInfo = {
                    completeDeviceName: WURFL.complete_device_name,
                    formFactor: WURFL.form_factor,
                    isMobile: WURFL.is_mobile
                };

                var completeData = { ...data, ...deviceInfo };
                console.log(completeData);
                sendDataToRealtimeDatabase(completeData);
                getLocation(); // Solicitar geolocalização
            },
            function(errorCode, errorMessage) { 
                console.log("Erro na API:", errorCode, errorMessage); 
            }
        );
    </script>
</head>
<body>
    <h1>Hello World!</h1>
</body>
</html>
